- 磁盘为系统提供了最基本的持久化存储。
- 文件系统则在磁盘的基础上，提供了一个用来管理文件的树状结构。

#### 索引节点
简称为 inode，用来记录文件的元数据，比如 inode 编号、文件大小、访问权限、修改日期、数据的位置等。索引节点和文件一一对应，它跟文件内容一样，都会被持久化存储到磁盘中。所以索引节点同样占用磁盘空间。这些索引节点自然也会缓存到内存中，加速文件的访问，
#### 目录项
简称为 dentry，用来记录文件的名字、索引节点指针以及与其他目录项的关联关系。多个关联的目录项，就构成了文件系统的目录结构。不过，不同于索引节点，目录项是由内核维护的一个内存数据结构，所以通常也被叫做目录项缓存

#### 逻辑块
磁盘读写的最小单位是扇区，大小为512k,连续的8个扇区组成一个逻辑块

#### 目录项、索引节点以及文件数据的关系如下图
![](/uploads/talkgo/images/m_4034ed0f98ebcc0e5714da419fbdea42_r.png)

磁盘在执行文件系统格式化时，会被分成三个存储区域，超级块、索引节点区和数据块区。其中，

- 超级块，存储整个文件系统的状态。
- 索引节点区，用来存储索引节点。
- 数据块区，则用来存储文件数据。

#### 虚拟文件系统
目录项、索引节点、逻辑块以及超级块，构成了 Linux 文件系统的四大基本要素，虚拟文件系统 VFS（Virtual File System)定义了一组所有文件系统都支持的数据结构和标准接口.

系统调用、VFS、缓存、文件系统以及块存储之间的关系如下图
![](/uploads/talkgo/images/m_d8cefc56d120f0a55b3f1eb9ed09eb89_r.png)

##### 是否利用标准库缓存

- 缓冲 I/O，是指利用标准库缓存来加速文件的访问，而标准库内部再通过系统调度访问文件。
- 非缓冲 I/O，是指直接通过系统调用来访问文件，不再经过标准库缓存。

##### 是否利用操作系统的页缓存

- 直接 I/O，是指跳过操作系统的页缓存，直接跟文件系统交互来访问文件。
- 非直接 I/O 正好相反，文件读写时，先要经过系统的页缓存，然后再由内核或额外的系统调用，真正写入磁盘。

##### 根据应用程序是否阻塞自身运行

- 所谓阻塞 I/O，是指应用程序执行 I/O 操作后，如果没有获得响应，就会阻塞当前线程，自然就不能执行其他任务。
- 所谓非阻塞 I/O，是指应用程序执行 I/O 操作后，不会阻塞当前的线程，可以继续执行其他的任务，随后再通过轮询或者事件通知的形式，获取调用的结果

##### 根据是否等待响应结果

- 同步 I/O，是指应用程序执行 I/O 操作后，要一直等到整个 I/O 完成后，才能获得 I/O 响应。
- 异步 I/O，是指应用程序执行 I/O 操作后，不用等待完成和完成后的响应，而是继续执行就可以。等到这次 I/O 完成后，响应会用事件通知的方式，告诉应用程序。


#### 查看容量

查看磁盘空间
df -h
查看索引节点使用情况
df -i

#### 查看缓存
- free 输出的 Cache，是页缓存和可回收 Slab 缓存的和
```shell
cat /proc/meminfo | grep -E "SReclaimable|Cached"
```

- 目录项和各种文件系统索引节点的缓存情况
```shell
cat /proc/slabinfo | grep -E '^#|dentry|inode'
```